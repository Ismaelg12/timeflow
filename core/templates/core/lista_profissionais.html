<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ titulo }} - TimeFlow</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <div class="container-fluid py-4">
        <!-- Cabeçalho -->
        <div class="d-flex justify-content-between align-items-center mb-4">
            <div>
                <h1 class="h3 mb-1">
                    <i class="fas fa-users text-primary"></i>
                    {{ titulo }}
                </h1>
                <p class="text-muted mb-0">
                    Total: {{ total_profissionais }} profissionais 
                    ({{ ativos_count }} ativos, {{ inativos_count }} inativos)
                </p>
            </div>
            <div class="d-flex gap-2">
                {% if eh_admin %}
                <a href="{% url 'core:cadastrar_profissional_admin' %}" class="btn btn-primary">
                    <i class="fas fa-plus"></i> Novo Profissional
                </a>
                {% endif %}
                <a href="{% url 'core:dashboard' %}" class="btn btn-secondary">
                    <i class="fas fa-arrow-left"></i> Voltar
                </a>
            </div>
        </div>

        <!-- Filtros -->
        <div class="card mb-4">
            <div class="card-body">
                <form method="get" class="row g-3">
                    <div class="col-md-4">
                        <label for="q" class="form-label">Buscar</label>
                        <input type="text" class="form-control" id="q" name="q" 
                               value="{{ query }}" placeholder="Nome, CPF ou email...">
                    </div>
                    <div class="col-md-3">
                        <label for="ativo" class="form-label">Status</label>
                        <select class="form-select" id="ativo" name="ativo">
                            <option value="">Todos</option>
                            <option value="true" {% if ativo_filter == 'true' %}selected{% endif %}>Ativos</option>
                            <option value="false" {% if ativo_filter == 'false' %}selected{% endif %}>Inativos</option>
                        </select>
                    </div>
                    <div class="col-md-3">
                        <label for="ordenacao" class="form-label">Ordenar por</label>
                        <select class="form-select" id="ordenacao" name="ordenacao">
                            <option value="-data_cadastro" {% if ordenacao == '-data_cadastro' %}selected{% endif %}>Mais Recentes</option>
                            <option value="data_cadastro" {% if ordenacao == 'data_cadastro' %}selected{% endif %}>Mais Antigos</option>
                            <option value="nome" {% if ordenacao == 'nome' %}selected{% endif %}>Nome A-Z</option>
                            <option value="-nome" {% if ordenacao == '-nome' %}selected{% endif %}>Nome Z-A</option>
                            <option value="cpf" {% if ordenacao == 'cpf' %}selected{% endif %}>CPF</option>
                        </select>
                    </div>
                    <div class="col-md-2 d-flex align-items-end">
                        <button type="submit" class="btn btn-primary w-100">
                            <i class="fas fa-filter"></i> Filtrar
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Lista de Profissionais -->
        <div class="card">
            <div class="card-body p-0">
                <div class="table-responsive">
                    <table class="table table-hover mb-0">
                        <thead class="table-light">
                            <tr>
                                <th>Nome</th>
                                <th>CPF</th>
                                <th>Email</th>
                                <th>Profissão</th>
                                <th>Status</th>
                                <th>Cadastro</th>
                                <th>Ações</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for profissional in profissionais %}
                            <tr>
                                <td>
                                    <strong>{{ profissional.nome_completo }}</strong>
                                </td>
                                <td>{{ profissional.cpf }}</td>
                                <td>{{ profissional.email|default:"-" }}</td>
                                <td>{{ profissional.profissao.nome|default:"-" }}</td>
                                <td>
                                    <span class="badge {% if profissional.ativo %}bg-success{% else %}bg-danger{% endif %}">
                                        {% if profissional.ativo %}Ativo{% else %}Inativo{% endif %}
                                    </span>
                                </td>
                                <td>{{ profissional.data_cadastro|date:"d/m/Y" }}</td>
                                <td>
                                    <div class="btn-group btn-group-sm">
                                        <a href="#" 
                                           class="btn btn-outline-primary" title="Ver detalhes">
                                            <i class="fas fa-eye"></i>
                                        </a>
                                        {% if eh_admin %}
                                        <a href="{% url 'core:editar_profissional_admin' profissional.id %}" 
                                           class="btn btn-outline-secondary" title="Editar">
                                            <i class="fas fa-edit"></i>
                                        </a>
                                        <a href="{% url 'core:relatorio_profissional' profissional.id %}" 
                                           class="btn btn-outline-info" title="Relatório">
                                            <i class="fas fa-chart-line"></i>
                                        </a>
                                        <a href="{% url 'core:desativar_profissional_admin' profissional.id %}" 
                                           class="btn {% if profissional.ativo %}btn-outline-warning{% else %}btn-outline-success{% endif %}"
                                           title="{% if profissional.ativo %}Desativar{% else %}Ativar{% endif %}">
                                            <i class="fas {% if profissional.ativo %}fa-ban{% else %}fa-check{% endif %}"></i>
                                        </a>
                                        {% endif %}
                                    </div>
                                </td>
                            </tr>
                            {% empty %}
                            <tr>
                                <td colspan="7" class="text-center py-4 text-muted">
                                    <i class="fas fa-users fa-2x mb-3"></i><br>
                                    Nenhum profissional encontrado.
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</body>
</html>